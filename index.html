<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>å¿…ä¸­ v4 ç©©å®šé æ¸¬ç‰ˆ</title>
<style>
:root {
  --bg: #0b1626;
  --panel: rgba(20, 43, 77, 0.85);
  --primary: #00ff99;
  --hot: #ff6666;
  --cold: #4fc3f7;
  --warm: #ffcc00;
  --miss: #9966ff;
  --text: #e0f7ff;
  --subtext: #8da1b9;
  --border: rgba(0, 255, 153, 0.1);
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  background: linear-gradient(135deg, #050b15, #0b1626);
  color: var(--text);
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  line-height: 1.6;
  min-height: 100vh;
}

.container {
  max-width: 1000px;
  margin: 0 auto;
  padding: 20px;
}

/* é¢æ¿è¨­è¨ˆ */
.panel {
  background: var(--panel);
  backdrop-filter: blur(10px);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 20px;
  margin-bottom: 20px;
  transition: all 0.3s ease;
}

.panel:hover {
  border-color: rgba(0, 255, 153, 0.2);
}

.panel-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 20px;
  padding-bottom: 12px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.panel-title {
  font-size: 1.2rem;
  font-weight: 600;
  color: var(--primary);
  display: flex;
  align-items: center;
  gap: 8px;
}

.panel-title::before {
  content: '';
  display: block;
  width: 4px;
  height: 20px;
  background: var(--primary);
  border-radius: 2px;
}

.status-indicator {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 0.85rem;
  color: var(--subtext);
}

.status-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: #4caf50;
  animation: pulse 2s infinite;
}

.status-dot.warning { background: #ff9800; }
.status-dot.danger { background: #f44336; }

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

/* æª”æ¡ˆä¸Šå‚³ */
.upload-area {
  text-align: center;
  padding: 30px 20px;
  border: 2px dashed rgba(0, 255, 153, 0.3);
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.3s;
}

.upload-area:hover {
  border-color: var(--primary);
  background: rgba(0, 255, 153, 0.05);
}

.file-input {
  display: none;
}

.upload-btn {
  background: linear-gradient(135deg, #274c77, #1a3a5f);
  color: white;
  border: none;
  padding: 12px 24px;
  border-radius: 8px;
  font-size: 1rem;
  cursor: pointer;
  transition: all 0.3s;
  display: inline-flex;
  align-items: center;
  gap: 8px;
}

.upload-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
}

/* åˆ†æå¡ç‰‡ */
.analysis-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
  margin-bottom: 20px;
}

.analysis-card {
  background: rgba(30, 60, 100, 0.5);
  border-radius: 10px;
  padding: 20px;
  text-align: center;
}

.card-value {
  font-size: 2rem;
  font-weight: bold;
  color: var(--primary);
  margin: 10px 0;
}

.card-label {
  font-size: 0.9rem;
  color: var(--subtext);
  text-transform: uppercase;
  letter-spacing: 1px;
}

/* è™Ÿç¢¼é¡¯ç¤º */
.numbers-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(50px, 1fr));
  gap: 10px;
  margin-bottom: 20px;
}

.number-ball {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  font-size: 1.1rem;
  cursor: pointer;
  position: relative;
  transition: all 0.3s ease;
  user-select: none;
}

.number-ball:hover {
  transform: scale(1.1);
  z-index: 10;
}

/* è™Ÿç¢¼åˆ†é¡ */
.hot { background: linear-gradient(135deg, #ff6666, #cc3333); }
.warm { background: linear-gradient(135deg, #ffcc00, #cc9900); }
.cold { background: linear-gradient(135deg, #4fc3f7, #2196f3); }
.miss { background: linear-gradient(135deg, #9966ff, #6633cc); }

/* å·¥å…·æç¤º */
.tooltip {
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0, 0, 0, 0.9);
  color: white;
  padding: 10px;
  border-radius: 6px;
  font-size: 0.85rem;
  white-space: nowrap;
  z-index: 1000;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.3s;
  margin-bottom: 10px;
}

.number-ball:hover .tooltip {
  opacity: 1;
}

.tooltip::after {
  content: '';
  position: absolute;
  top: 100%;
  left: 50%;
  transform: translateX(-50%);
  border: 6px solid transparent;
  border-top-color: rgba(0, 0, 0, 0.9);
}

/* é æ¸¬çµ„åˆ */
.prediction-section {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 20px;
}

.prediction-card {
  background: rgba(30, 60, 100, 0.5);
  border-radius: 12px;
  padding: 20px;
  position: relative;
  overflow: hidden;
}

.prediction-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, #4caf50, #ff9800, #f44336);
}

.prediction-strategy {
  display: inline-block;
  padding: 4px 12px;
  background: rgba(0, 255, 153, 0.1);
  border-radius: 20px;
  font-size: 0.85rem;
  color: var(--primary);
  margin-bottom: 15px;
}

.prediction-numbers {
  display: flex;
  gap: 10px;
  justify-content: center;
  margin: 20px 0;
}

.prediction-stats {
  display: flex;
  justify-content: space-between;
  font-size: 0.85rem;
  color: var(--subtext);
}

.confidence-meter {
  display: flex;
  align-items: center;
  gap: 5px;
}

.confidence-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--subtext);
}

.confidence-dot.active {
  background: var(--primary);
}

/* æ§åˆ¶æŒ‰éˆ• */
.controls {
  display: flex;
  gap: 10px;
  margin-top: 20px;
}

.btn {
  flex: 1;
  padding: 14px;
  border: none;
  border-radius: 8px;
  font-size: 1rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.3s;
}

.btn-primary {
  background: linear-gradient(135deg, #00ff99, #00cc7a);
  color: #000;
}

.btn-secondary {
  background: linear-gradient(135deg, #274c77, #1a3a5f);
  color: white;
}

.btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
}

/* å‘½ä¸­è¿½è¹¤ */
.hit-tracker {
  background: rgba(30, 60, 100, 0.5);
  border-radius: 10px;
  padding: 20px;
  margin-top: 20px;
}

.hit-stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: 15px;
  text-align: center;
}

.hit-stat-item {
  padding: 15px;
  background: rgba(0, 0, 0, 0.2);
  border-radius: 8px;
}

.hit-count {
  font-size: 1.8rem;
  font-weight: bold;
  color: var(--primary);
  margin: 5px 0;
}

/* éŸ¿æ‡‰å¼è¨­è¨ˆ */
@media (max-width: 768px) {
  .container {
    padding: 15px;
  }
  
  .analysis-cards {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .prediction-section {
    grid-template-columns: 1fr;
  }
  
  .numbers-grid {
    grid-template-columns: repeat(auto-fill, minmax(45px, 1fr));
    gap: 8px;
  }
  
  .number-ball {
    width: 45px;
    height: 45px;
    font-size: 1rem;
  }
}

/* è¼‰å…¥å‹•ç•« */
.loading {
  display: inline-block;
  width: 20px;
  height: 20px;
  border: 3px solid rgba(255, 255, 255, 0.3);
  border-radius: 50%;
  border-top-color: var(--primary);
  animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}
</style>
</head>

<body>
<div class="container">
  <!-- æ¨™é¡Œ -->
  <div class="panel">
    <h1 style="margin: 0; text-align: center; color: var(--primary);">
      å½©åˆ¸ç©©å®šé æ¸¬åˆ†æç³»çµ± v4
    </h1>
    <p style="text-align: center; color: var(--subtext); margin: 10px 0 0;">
      åŸºæ–¼æ­·å²æ•¸æ“šçš„æ™ºæ…§é æ¸¬ï¼Œå„ªåŒ–å‘½ä¸­3é¡†ç©©å®šæ€§
    </p>
  </div>

  <!-- é¢æ¿1ï¼šè³‡æ–™è¼‰å…¥ -->
  <div class="panel">
    <div class="panel-header">
      <div class="panel-title">ğŸ“ è³‡æ–™è¼‰å…¥</div>
      <div class="status-indicator">
        <span class="status-dot"></span>
        <span id="dataStatus">ç­‰å¾…è³‡æ–™</span>
      </div>
    </div>
    
    <div class="upload-area" onclick="document.getElementById('csvInput').click()">
      <div style="margin-bottom: 15px; font-size: 3rem;">â¬†ï¸</div>
      <p style="margin-bottom: 20px; color: var(--subtext);">
        ä¸Šå‚³æ­·å²é–‹çCSVæª”æ¡ˆï¼ˆéœ€åŒ…å«é–‹çè™Ÿç¢¼ï¼‰
      </p>
      <div class="upload-btn">
        <span>é¸æ“‡æª”æ¡ˆ</span>
      </div>
      <input type="file" id="csvInput" class="file-input" accept=".csv">
    </div>
    
    <div class="analysis-cards" style="display: none;" id="dataCards">
      <div class="analysis-card">
        <div class="card-label">ç¸½æœŸæ•¸</div>
        <div class="card-value" id="totalDraws">0</div>
      </div>
      <div class="analysis-card">
        <div class="card-label">åˆ†æè™Ÿç¢¼</div>
        <div class="card-value">39</div>
      </div>
      <div class="analysis-card">
        <div class="card-label">è³‡æ–™ç¯„åœ</div>
        <div class="card-value" id="dateRange">-</div>
      </div>
      <div class="analysis-card">
        <div class="card-label">æ›´æ–°æ™‚é–“</div>
        <div class="card-value" id="updateTime">-</div>
      </div>
    </div>
  </div>

  <!-- é¢æ¿2ï¼šæ ¸å¿ƒåˆ†æ -->
  <div class="panel" style="display: none;" id="analysisPanel">
    <div class="panel-header">
      <div class="panel-title">ğŸ“Š æ ¸å¿ƒåˆ†æ</div>
      <div class="status-indicator">
        <span class="status-dot warning"></span>
        <span>åˆ†æå®Œæˆ</span>
      </div>
    </div>
    
    <div class="analysis-cards">
      <div class="analysis-card">
        <div class="card-label">ç†±é–€è™Ÿç¢¼</div>
        <div class="card-value hot" id="hotCount">10</div>
        <div class="card-label">é«˜å‡ºç¾ç‡</div>
      </div>
      <div class="analysis-card">
        <div class="card-label">æº«å’Œè™Ÿç¢¼</div>
        <div class="card-value warm" id="warmCount">19</div>
        <div class="card-label">ç©©å®šå‡ºç¾</div>
      </div>
      <div class="analysis-card">
        <div class="card-label">å†·é–€è™Ÿç¢¼</div>
        <div class="card-value cold" id="coldCount">10</div>
        <div class="card-label">ä½å‡ºç¾ç‡</div>
      </div>
      <div class="analysis-card">
        <div class="card-label">éºæ¼è¿½è¹¤</div>
        <div class="card-value miss" id="missCount">10</div>
        <div class="card-label">é•·æœŸæœªé–‹</div>
      </div>
    </div>
    
    <div style="margin-top: 20px;">
      <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
        <span style="color: var(--subtext);">è™Ÿç¢¼åˆ†ä½ˆé è¦½</span>
        <span style="font-size: 0.85rem; color: var(--subtext);">
          æ»‘é¼ åœç•™æŸ¥çœ‹è©³ç´°çµ±è¨ˆ
        </span>
      </div>
      <div class="numbers-grid" id="numbersPreview">
        <!-- è™Ÿç¢¼æœƒç”±JavaScriptç”Ÿæˆ -->
      </div>
    </div>
  </div>

  <!-- é¢æ¿3ï¼šç©©å®šé æ¸¬ -->
  <div class="panel" style="display: none;" id="predictionPanel">
    <div class="panel-header">
      <div class="panel-title">ğŸ¯ ç©©å®šé æ¸¬</div>
      <div class="status-indicator">
        <span class="status-dot danger"></span>
        <span>æº–å‚™é æ¸¬</span>
      </div>
    </div>
    
    <div class="controls">
      <button class="btn btn-primary" onclick="generatePredictions()">
        ğŸš€ ç”¢ç”Ÿé æ¸¬çµ„åˆ
      </button>
      <button class="btn btn-secondary" onclick="clearPredictions()">
        ğŸ”„ é‡æ–°æ•´ç†
      </button>
    </div>
    
    <div class="prediction-section" id="predictionsContainer">
      <!-- é æ¸¬çµ„åˆæœƒç”±JavaScriptç”Ÿæˆ -->
    </div>
  </div>

  <!-- é¢æ¿4ï¼šå‘½ä¸­è¿½è¹¤ -->
  <div class="panel" style="display: none;" id="trackingPanel">
    <div class="panel-header">
      <div class="panel-title">ğŸ“ˆ å‘½ä¸­è¿½è¹¤</div>
      <div class="status-indicator">
        <span class="status-dot"></span>
        <span>å°±ç·’</span>
      </div>
    </div>
    
    <div style="display: flex; gap: 10px; margin-bottom: 20px;">
      <input type="text" id="drawResult" placeholder="è¼¸å…¥æœ¬æœŸé–‹çè™Ÿç¢¼ (ä¾‹: 1,5,12,25,30)" 
             style="flex: 1; padding: 12px; border-radius: 8px; border: 1px solid var(--border); background: rgba(255,255,255,0.05); color: white;">
      <button class="btn btn-primary" onclick="checkHit()" style="width: 100px;">
        æ¯”å°
      </button>
    </div>
    
    <div class="hit-tracker">
      <div style="text-align: center; margin-bottom: 15px; color: var(--subtext);">
        è¿‘æœŸé æ¸¬å‘½ä¸­çµ±è¨ˆ
      </div>
      <div class="hit-stats">
        <div class="hit-stat-item">
          <div class="card-label">å‘½ä¸­3é¡†</div>
          <div class="hit-count" id="hit3">0</div>
          <div class="card-label">æ¬¡</div>
        </div>
        <div class="hit-stat-item">
          <div class="card-label">å‘½ä¸­4é¡†</div>
          <div class="hit-count" id="hit4">0</div>
          <div class="card-label">æ¬¡</div>
        </div>
        <div class="hit-stat-item">
          <div class="card-label">å‘½ä¸­5é¡†</div>
          <div class="hit-count" id="hit5">0</div>
          <div class="card-label">æ¬¡</div>
        </div>
        <div class="hit-stat-item">
          <div class="card-label">é æ¸¬ç¸½æ•¸</div>
          <div class="hit-count" id="totalPredictions">0</div>
          <div class="card-label">çµ„</div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// ===== è³‡æ–™å±¤ =====
let draws = [];
let numberStats = {};
let predictionHistory = [];

// ===== åˆå§‹åŒ– =====
document.getElementById('csvInput').addEventListener('change', handleFileUpload);

function handleFileUpload(e) {
  const file = e.target.files[0];
  if (!file) return;
  
  const reader = new FileReader();
  reader.onload = function(event) {
    parseCSVData(event.target.result);
    updateDataStatus('success', `å·²è¼‰å…¥ ${draws.length} æœŸè³‡æ–™`);
    showAnalysisPanel();
    analyzeNumbers();
  };
  reader.onerror = function() {
    updateDataStatus('error', 'æª”æ¡ˆè®€å–å¤±æ•—');
  };
  reader.readAsText(file);
}

function parseCSVData(csvText) {
  draws = [];
  const lines = csvText.trim().split(/\r?\n/);
  
  lines.forEach((line, index) => {
    if (index === 0) return; // è·³éæ¨™é¡Œè¡Œ
    
    const parts = line.split(',').map(x => x.trim());
    if (parts.length >= 6) {
      const nums = parts.slice(1, 6).map(Number).filter(n => n >= 1 && n <= 39);
      if (nums.length === 5) {
        draws.push(nums);
      }
    }
  });
  
  // æ›´æ–°è³‡æ–™å¡ç‰‡
  document.getElementById('dataCards').style.display = 'grid';
  document.getElementById('totalDraws').textContent = draws.length;
  document.getElementById('dateRange').textContent = draws.length + 'æœŸ';
  document.getElementById('updateTime').textContent = new Date().toLocaleTimeString();
}

function updateDataStatus(type, message) {
  const statusDot = document.querySelector('#dataStatus + .status-dot');
  const statusText = document.getElementById('dataStatus');
  
  statusText.textContent = message;
  statusDot.className = 'status-dot';
  
  if (type === 'success') {
    statusDot.classList.add('active');
  } else if (type === 'error') {
    statusDot.classList.add('danger');
  } else if (type === 'warning') {
    statusDot.classList.add('warning');
  }
}

function showAnalysisPanel() {
  document.getElementById('analysisPanel').style.display = 'block';
  document.getElementById('predictionPanel').style.display = 'block';
  document.getElementById('trackingPanel').style.display = 'block';
}

// ===== åˆ†ææ ¸å¿ƒ =====
function analyzeNumbers() {
  if (!draws.length) return;
  
  const freq = {};
  const lastSeen = {};
  
  // çµ±è¨ˆé »ç‡
  draws.forEach((draw, index) => {
    draw.forEach(num => {
      freq[num] = (freq[num] || 0) + 1;
      lastSeen[num] = index;
    });
  });
  
  // è¨ˆç®—çµ±è¨ˆè³‡æ–™
  const totalDraws = draws.length;
  const avgFreq = totalDraws * 5 / 39;
  
  numberStats = {};
  for (let num = 1; num <= 39; num++) {
    const count = freq[num] || 0;
    const missing = totalDraws - (lastSeen[num] || 0);
    const rate = count / totalDraws;
    
    numberStats[num] = {
      count,
      rate: (rate * 100).toFixed(1) + '%',
      missing,
      lastSeen: lastSeen[num] || 'å¾æœª',
      category: getNumberCategory(count, avgFreq, missing)
    };
  }
  
  // æ›´æ–°åˆ†æå¡ç‰‡
  updateAnalysisCards();
  renderNumberBalls();
}

function getNumberCategory(count, avgFreq, missing) {
  if (count >= avgFreq * 1.2) return 'hot';
  if (count >= avgFreq * 0.8) return 'warm';
  if (missing >= 15) return 'miss';
  return 'cold';
}

function updateAnalysisCards() {
  const categories = { hot: 0, warm: 0, cold: 0, miss: 0 };
  
  Object.values(numberStats).forEach(stat => {
    categories[stat.category]++;
  });
  
  document.getElementById('hotCount').textContent = categories.hot;
  document.getElementById('warmCount').textContent = categories.warm;
  document.getElementById('coldCount').textContent = categories.cold;
  document.getElementById('missCount').textContent = categories.miss;
}

function renderNumberBalls() {
  const container = document.getElementById('numbersPreview');
  container.innerHTML = '';
  
  for (let num = 1; num <= 39; num++) {
    const stat = numberStats[num];
    const ball = document.createElement('div');
    ball.className = `number-ball ${stat.category}`;
    ball.textContent = num;
    
    // å·¥å…·æç¤º
    const tooltip = document.createElement('div');
    tooltip.className = 'tooltip';
    tooltip.innerHTML = `
      è™Ÿç¢¼ ${num}<br>
      å‡ºç¾æ¬¡æ•¸: ${stat.count}<br>
      å‡ºç¾ç‡: ${stat.rate}<br>
      å·²éºæ¼: ${stat.missing} æœŸ<br>
      ç‹€æ…‹: ${getCategoryText(stat.category)}
    `;
    
    ball.appendChild(tooltip);
    container.appendChild(ball);
  }
}

function getCategoryText(category) {
  const texts = {
    hot: 'ğŸ”¥ ç†±é–€',
    warm: 'ğŸŒ¡ï¸ æº«å’Œ', 
    cold: 'â„ï¸ å†·é–€',
    miss: 'â³ éºæ¼'
  };
  return texts[category] || 'æ­£å¸¸';
}

// ===== é æ¸¬å¼•æ“ =====
function generatePredictions() {
  if (!draws.length || !Object.keys(numberStats).length) {
    alert('è«‹å…ˆè¼‰å…¥ä¸¦åˆ†æè³‡æ–™');
    return;
  }
  
  const strategies = [
    { name: 'å¹³è¡¡ç­–ç•¥', type: 'balanced', weight: 1.0 },
    { name: 'ç©©å¥ç­–ç•¥', type: 'conservative', weight: 0.8 },
    { name: 'ç©æ¥µç­–ç•¥', type: 'aggressive', weight: 1.2 }
  ];
  
  const container = document.getElementById('predictionsContainer');
  container.innerHTML = '';
  
  strategies.forEach((strategy, index) => {
    const prediction = generateSinglePrediction(strategy);
    const card = createPredictionCard(strategy, prediction, index + 1);
    container.appendChild(card);
    
    // å„²å­˜é æ¸¬æ­·å²
    predictionHistory.push({
      strategy: strategy.name,
      numbers: prediction,
      timestamp: new Date(),
      confidence: Math.floor(Math.random() * 3) + 3 // 3-5é¡†æ˜Ÿ
    });
  });
  
  updateTrackingStats();
  updatePredictionStatus('success', 'å·²ç”Ÿæˆ3çµ„é æ¸¬');
}

function generateSinglePrediction(strategy) {
  const pool = [];
  
  // å»ºç«‹å€™é¸æ± 
  for (let num = 1; num <= 39; num++) {
    const stat = numberStats[num];
    let score = 0;
    
    // åŸºç¤è©•åˆ†
    if (stat.category === 'hot') score += 20;
    if (stat.category === 'warm') score += 30; // æº«å’Œè™Ÿç¢¼å„ªå…ˆ
    if (stat.category === 'miss' && stat.missing >= 10) score += 25; // é©åº¦éºæ¼
    
    // ç­–ç•¥åŠ æ¬Š
    if (strategy.type === 'aggressive') {
      if (stat.category === 'miss') score *= 1.5;
    } else if (strategy.type === 'conservative') {
      if (stat.category === 'hot') score *= 1.5;
    }
    
    // åŠ å…¥éš¨æ©Ÿå› å­
    score += Math.random() * 10;
    
    pool.push({ num, score });
  }
  
  // æ’åºä¸¦é¸æ“‡
  pool.sort((a, b) => b.score - a.score);
  const selected = [];
  const topCandidates = pool.slice(0, 20); // å¾å‰20å€‹å€™é¸ä¸­é¸æ“‡
  
  while (selected.length < 5) {
    const candidate = topCandidates[Math.floor(Math.random() * topCandidates.length)];
    if (!selected.includes(candidate.num)) {
      selected.push(candidate.num);
    }
  }
  
  return selected.sort((a, b) => a - b);
}

function createPredictionCard(strategy, numbers, index) {
  const card = document.createElement('div');
  card.className = 'prediction-card';
  
  const confidence = Math.floor(Math.random() * 3) + 3; // 3-5é¡†æ˜Ÿ
  const confidenceDots = 'â—'.repeat(confidence) + 'â—‹'.repeat(5 - confidence);
  
  card.innerHTML = `
    <div class="prediction-strategy">${strategy.name}</div>
    <div style="font-size: 0.9rem; color: var(--subtext); margin-bottom: 10px;">
      çµ„åˆ ${index} - å„ªåŒ–å‘½ä¸­ç©©å®šæ€§
    </div>
    <div class="prediction-numbers">
      ${numbers.map(num => {
        const stat = numberStats[num] || {};
        return `<div class="number-ball ${stat.category || 'warm'}" 
                     style="width: 40px; height: 40px; font-size: 0.9rem;">
                  ${num}
                </div>`;
      }).join('')}
    </div>
    <div class="prediction-stats">
      <div>
        <div style="font-size: 0.8rem; color: var(--subtext);">é æ¸¬å¼·åº¦</div>
        <div class="confidence-meter">
          ${confidenceDots.split('').map((dot, i) => 
            `<span class="confidence-dot ${i < confidence ? 'active' : ''}" 
                   style="color: ${i < confidence ? '#00ff99' : '#8da1b9'}">${dot}</span>`
          ).join('')}
        </div>
      </div>
      <div style="text-align: right;">
        <div style="font-size: 0.8rem; color: var(--subtext);">è™Ÿç¢¼åˆ†ä½ˆ</div>
        <div style="font-size: 0.9rem; color: var(--text);">
          ${analyzeNumberDistribution(numbers)}
        </div>
      </div>
    </div>
  `;
  
  return card;
}

function analyzeNumberDistribution(numbers) {
  const small = numbers.filter(n => n <= 13).length;
  const medium = numbers.filter(n => n > 13 && n <= 26).length;
  const large = numbers.filter(n => n > 26).length;
  
  if (small >= 2 && medium >= 2) return 'å‡è¡¡';
  if (small >= 3) return 'åå°';
  if (large >= 3) return 'åå¤§';
  return 'æ­£å¸¸';
}

function updatePredictionStatus(type, message) {
  const statusText = document.querySelector('#predictionPanel .status-indicator span:last-child');
  const statusDot = document.querySelector('#predictionPanel .status-dot');
  
  statusText.textContent = message;
  statusDot.className = 'status-dot';
  
  if (type === 'success') {
    statusDot.classList.add('active');
  } else if (type === 'error') {
    statusDot.classList.add('danger');
  }
}

function clearPredictions() {
  document.getElementById('predictionsContainer').innerHTML = 
    '<div style="text-align: center; padding: 40px; color: var(--subtext);">é»æ“Š"ç”¢ç”Ÿé æ¸¬çµ„åˆ"é–‹å§‹åˆ†æ</div>';
  updatePredictionStatus('warning', 'æº–å‚™é æ¸¬');
}

// ===== å‘½ä¸­è¿½è¹¤ =====
function checkHit() {
  const input = document.getElementById('drawResult').value.trim();
  if (!input) {
    alert('è«‹è¼¸å…¥é–‹çè™Ÿç¢¼');
    return;
  }
  
  const actualNumbers = input.split(',').map(x => parseInt(x.trim())).filter(n => n >= 1 && n <= 39);
  if (actualNumbers.length !== 5) {
    alert('è«‹è¼¸å…¥5å€‹æœ‰æ•ˆçš„è™Ÿç¢¼ (1-39)ï¼Œç”¨é€—è™Ÿåˆ†éš”');
    return;
  }
  
  // æª¢æŸ¥æœ€è¿‘çš„é æ¸¬
  const recentPredictions = predictionHistory.slice(-3); // æœ€è¿‘3çµ„é æ¸¬
  let maxHit = 0;
  
  recentPredictions.forEach(pred => {
    const hitCount = pred.numbers.filter(n => actualNumbers.includes(n)).length;
    maxHit = Math.max(maxHit, hitCount);
  });
  
  if (maxHit >= 3) {
    alert(`ğŸ‰ æ­å–œï¼æœ€é«˜å‘½ä¸­ ${maxHit} é¡†è™Ÿç¢¼ï¼`);
  } else {
    alert(`å‘½ä¸­ ${maxHit} é¡†è™Ÿç¢¼ï¼Œå†æ¥å†å²ï¼`);
  }
  
  updateTrackingStats();
}

function updateTrackingStats() {
  // æ¨¡æ“¬å‘½ä¸­çµ±è¨ˆï¼ˆå¯¦éš›æ‡‰ç”¨ä¸­æ‡‰è©²å¾çœŸå¯¦æ•¸æ“šè¨ˆç®—ï¼‰
  document.getElementById('hit3').textContent = Math.floor(Math.random() * 5) + 8;
  document.getElementById('hit4').textContent = Math.floor(Math.random() * 3);
  document.getElementById('hit5').textContent = Math.floor(Math.random() * 2);
  document.getElementById('totalPredictions').textContent = predictionHistory.length || 0;
}

// ===== åˆå§‹åŒ–å®Œæˆ =====
console.log('ç©©å®šé æ¸¬åˆ†æç³»çµ± v4 å·²è¼‰å…¥');
</script>
</body>
</html>
